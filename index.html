<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>The Magic Eye</title>
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css">
     </head>



    <body style="margin:0px auto; vertical-align:center; padding-top:20px; text-align: center;">
    <div style="padding: 100px 0; text-align: center; " id="rendering">
            Rendering...
        </div>
        <div class="container">
        <div class="row">
        <div class="col-md-12">


        <script type="text/javascript">

        //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
        //
        //          DATA LOADING PART
        //
        //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


        var dayIndex = 0;


        var listElectricity = [

                                [0.0999999999999091,
                                    0.0999999999999091,
                                    0.0999999999999091,
                                    0.3800000000001090,
                                    0.2999999999997270,
                                    0.0900000000001455,
                                    0.0900000000001455,
                                    0.1599999999998540,
                                    0.5100000000002180,
                                    1.1799999999998400,
                                    1.3699999999998900,
                                    0.6400000000003270,
                                    0.9199999999996180,
                                    1.0300000000002000,
                                    1.2699999999999800,
                                    0.5799999999999270,
                                    0.6100000000001270,
                                    1.1300000000001100,
                                    0.5499999999997270,
                                    0.4500000000002730,
                                    1.0699999999997100,
                                    0.6300000000001090,
                                    1.1399999999998700,
                                    0.5599999999999450],

                                [0.4000000000000910
                                    0.1199999999998910
                                    0.1500000000000910
                                    0.1100000000001270
                                    0.0900000000001455
                                    0.0999999999999091
                                    0.3200000000001640
                                    0.3699999999998910
                                    0.1199999999998910
                                    0.4899999999997820
                                    0.7800000000002000
                                    0.6300000000001090
                                    0.4299999999998360
                                    0.2000000000002730
                                    0.4299999999998360
                                    0.2799999999997450
                                    0.3900000000003270
                                    0.4099999999998540
                                    0.1700000000000730
                                    0.1399999999998730
                                    0.3800000000001090
                                    1.8000000000001800
                                    0.7899999999999640
                                    0.3799999999996540],

                                [0.2000000000002730
                                    0.0899999999996908
                                    0.1100000000001270
                                    0.0799999999999272
                                    0.2200000000002550
                                    0.3899999999998730
                                    0.1500000000000910
                                    0.0799999999999272
                                    0.0999999999999091
                                    0.7000000000002730
                                    2.9199999999996200
                                    1.9400000000000500
                                    2.9900000000002400
                                    2.4600000000000400
                                    1.0499999999997300
                                    0.4700000000002550
                                    0.7500000000000000
                                    0.4699999999998000
                                    0.7600000000002180
                                    0.5299999999997450
                                    0.4500000000002730
                                    0.3499999999999090
                                    0.5799999999999270
                                    0.3699999999998910],

                                [0.1100000000001270
                                    0.0900000000001455
                                    0.0899999999996908
                                    0.1100000000001270
                                    0.0900000000001455
                                    0.3800000000001090
                                    0.4299999999998360
                                    0.2399999999997820
                                    0.1100000000001270
                                    0.2400000000002360
                                    0.2300000000000180
                                    0.1199999999998910
                                    0.0799999999999272
                                    0.3299999999999270
                                    0.3600000000001270
                                    0.3099999999999450
                                    0.9600000000000360
                                    0.4200000000000730
                                    0.6299999999996540
                                    0.8000000000001820
                                    0.3600000000001270
                                    0.4600000000000360
                                    0.4499999999998180
                                    0.2300000000000180],

                                [0.0999999999999091
                                    0.1100000000001270
                                    0.0900000000001455
                                    0.0899999999996908
                                    0.2100000000000360
                                    0.4600000000000360
                                    0.1600000000003090
                                    0.0799999999999272
                                    0.0999999999999091
                                    0.2599999999997640
                                    0.2300000000000180
                                    0.1400000000003270
                                    0.3799999999996540
                                    0.2600000000002180
                                    0.1399999999998730
                                    0.0900000000001455
                                    1.0099999999997600
                                    0.5000000000000000
                                    0.4200000000000730
                                    0.4500000000002730
                                    0.4600000000000360
                                    0.1599999999998540
                                    0.2399999999997820
                                    0.1000000000003640],

                                [0.0999999999999091
                                    0.0899999999996908
                                    0.1400000000003270
                                    0.3899999999998730
                                    0.2500000000000000
                                    0.1700000000000730
                                    0.0999999999999091
                                    0.0900000000001455
                                    0.1199999999998910
                                    0.2199999999998000
                                    0.4400000000000550
                                    0.3900000000003270
                                    0.1199999999998910
                                    0.2500000000000000
                                    1.0599999999999500
                                    0.4800000000000180
                                    0.4499999999998180
                                    1.2000000000002700
                                    1.1399999999998700
                                    0.5399999999999640
                                    0.1599999999998540
                                    0.1700000000000730
                                    0.3099999999999450
                                    0.2000000000002730]

                                [0.0999999999999091
                                    0.3699999999998910
                                    0.3000000000001820
                                    0.0899999999996908
                                    0.0900000000001455
                                    0.1599999999998540
                                    0.1700000000000730
                                    0.1900000000000550
                                    0.3600000000001270
                                    0.4600000000000360
                                    0.2500000000000000
                                    0.0999999999999091
                                    0.0900000000001455
                                    0.0799999999999272
                                    0.3899999999998730
                                    0.5399999999999640
                                    0.8299999999999270
                                    0.5599999999999450
                                    0.4100000000003090
                                    0.4699999999998000
                                    0.4000000000000910
                                    0.2800000000002000
                                    0.2899999999999640
                                    0.3599999999996730]
        ]



        var listColdWater = [[0.003000000000000110,
                            0.000000000000000000,
                            0.000000000000000000,
                            0.000000000000000000,
                            0.000000000000000000,
                            0.000000000000000000,
                            0.000000000000000000,
                            0.000000000000000000,
                            0.000999999999990564,
                            0.058000000000006900,
                            0.004999999999995450,
                            0.003000000000000110,
                            0.088999999999998600,
                            0.015000000000000600,
                            0.031000000000005900,
                            0.081999999999993600,
                            0.032000000000010700,
                            0.009999999999990910,
                            0.016000000000005300,
                            0.010999999999995700,
                            0.006000000000000230,
                            0.034000000000006000,
                            0.018999999999991200,
                            0.029000000000010600],


                            [0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.003999999999990680
                            0.004000000000004890
                            0.015000000000000600
                            0.024000000000000900
                            0.049999999999997200
                            0.052999999999997300
                            0.000000000000000000
                            0.000000000000000000
                            0.002000000000009550
                            0.000000000000000000
                            0.005999999999986020
                            0.005000000000009660
                            0.004999999999995450
                            0.013000000000005200
                            0.045000000000001700
                            0.018999999999991200
                            0.005000000000009660],

                            [0.003999999999990680
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.003000000000000110
                            0.018000000000000700
                            0.081000000000003100
                            0.052999999999997300
                            0.067000000000007300
                            0.039999999999992000
                            0.000000000000000000
                            0.008000000000009780
                            0.011999999999986200
                            0.015000000000000600
                            0.030000000000001100
                            0.000000000000000000
                            0.010000000000005100
                            0.018000000000000700
                            0.000000000000000000
                            0.004000000000004890],

                            [0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.012000000000000500
                            0.021999999999991400
                            0.000000000000000000
                            0.000000000000000000
                            0.003000000000000110
                            0.013999999999995800
                            0.043000000000006400
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.013000000000005200
                            0.006999999999990790
                            0.000000000000000000
                            0.000000000000000000
                            0.064000000000007200
                            0.039999999999992000
                            0.000000000000000000
                            0.000000000000000000
                            0.004000000000004890],


                            [0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.010999999999995700
                            0.012000000000000500
                            0.000000000000000000
                            0.000000000000000000
                            0.003000000000000110
                            0.011000000000009900
                            0.050999999999987700
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.028000000000005800
                            0.000000000000000000
                            0.001999999999995340
                            0.001000000000004770
                            0.063000000000002400
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.004000000000004890
                            0.000000000000000000],

                            [0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.009999999999990910
                            0.015000000000000600
                            0.000000000000000000
                            0.000000000000000000
                            0.006000000000000230
                            0.007000000000005000
                            0.031999999999996500
                            0.000000000000000000
                            0.000000000000000000
                            0.004000000000004890
                            0.021999999999991400
                            0.000000000000000000
                            0.009000000000000340
                            0.109999999999999000
                            0.007000000000005000
                            0.004999999999995450
                            0.005000000000009660
                            0.000999999999990564
                            0.001000000000004770
                            0.000000000000000000],

                            [0.004000000000004890
                            0.000000000000000000
                            0.000000000000000000
                            0.000000000000000000
                            0.012000000000000500
                            0.028999999999996400
                            0.003000000000000110
                            0.010999999999995700
                            0.004999999999995450
                            0.000000000000000000
                            0.040000000000006300
                            0.001000000000004770
                            0.000000000000000000
                            0.000000000000000000
                            0.018000000000000700
                            0.000000000000000000
                            0.060999999999992800
                            0.004999999999995450
                            0.003000000000000110
                            0.085000000000008000
                            0.001999999999995340
                            0.007000000000005000
                            0.000000000000000000
                            0.003999999999990680]


                            ]


        var listWarmWater = [

                            [0.00000000000000000,
                            0.00000000000000000,
                            0.00000000000000000,
                            0.00000000000000000,
                            0.00000000000000000,
                            0.00000000000000000,
                            0.00000000000000000,
                            0.00000000000000000,
                            0.00000000000000000,
                            0.05599999999999740,
                            0.00000000000000000,
                            0.00000000000000000,
                            0.04200000000000160,
                            0.00400000000000489,
                            0.00900000000000034,
                            0.05999999999998810,
                            0.01600000000000530,
                            0.00000000000000000,
                            0.00799999999999557,
                            0.00200000000000955,
                            0.00099999999999056,
                            0.03700000000000610,
                            0.00100000000000477,
                            0.00600000000000023],

                            [0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00499999999999545
                            0.01800000000000070
                            0.07899999999999350
                            0.04399999999999690
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00100000000000477
                            0.00000000000000000
                            0.00000000000000000
                            0.00400000000000489
                            0.05700000000000220
                            0.00099999999999056
                            0.00300000000000011],

                            [0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.01700000000001010
                            0.01099999999999570
                            0.00799999999999557
                            0.04300000000000640
                            0.00000000000000000
                            0.00199999999999534
                            0.00700000000000500
                            0.00000000000000000
                            0.05100000000000190
                            0.00000000000000000
                            0.00199999999999534
                            0.00100000000000477
                            0.00000000000000000
                            0.00300000000000011],

                            [0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00499999999999545
                            0.04800000000000180
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.01299999999999100
                            0.00000000000000000
                            0.00000000000000000
                            0.07100000000001220
                            0.04499999999998750
                            0.00000000000000000
                            0.00000000000000000
                            0.00300000000000011],

                            [0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00600000000000023
                            0.01000000000000510
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00400000000000489
                            0.04599999999999230
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.03600000000000140
                            0.00000000000000000
                            0.00199999999999534
                            0.00100000000000477
                            0.09100000000000820
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00300000000000011
                            0.00000000000000000],

                            [0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00499999999999545
                            0.03099999999999170
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00800000000000978
                            0.00000000000000000
                            0.00600000000000023
                            0.14699999999999100
                            0.00600000000000023
                            0.00000000000000000
                            0.00100000000000477
                            0.00100000000000477
                            0.00000000000000000
                            0.00000000000000000],

                            [0.00300000000000011
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.00199999999999534
                            0.00000000000000000
                            0.00000000000000000
                            0.04099999999999680
                            0.00000000000000000
                            0.00000000000000000
                            0.00000000000000000
                            0.01200000000000050
                            0.00000000000000000
                            0.06900000000000260
                            0.00100000000000477
                            0.00000000000000000
                            0.09099999999999400
                            0.00000000000000000
                            0.00499999999999545
                            0.00000000000000000
                            0.00300000000000011]
                            ]


        function updateData(dataToUpdate){

        }


        //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
        //
        //          DATA TRANSFORMATION PART
        //
        //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$






        function transformData(dataToTransform){

                var returnData = []

                dataToTransform.forEach(function(d) {

                      var dstring = d.toString()
                      dstring = dstring.replace(".", "")
                      dstring = dstring.substr(0, 4)

                      //listElectricityConvert.push(dstring)

                      var newList = []
                      newList.push(+ dstring.charAt(0))
                      newList.push(+ dstring.charAt(1))
                      newList.push(+ dstring.charAt(2))
                      newList.push(+ dstring.charAt(3))

                    returnData.push(newList)


                  })

                return returnData
            }







        //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
        //
        //          DATA TRANSFORMATION PART II BLENDING COLORS
        //
        //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


        function interpolateData(dataToInterpolate, howManyTimes){

            function interpolateHorizontally(arrayToInterpolate){

                var arrayToReturn = []

                arrayToInterpolate.forEach(function(horizontalList){

                    var horizontalListInterpolated = []

                    horizontalList.forEach(function(digit, index, horizontalList){

                        horizontalListInterpolated.push(digit)

                        if(index != horizontalList.length-1){
                            var nextDigit = horizontalList[index+1]
                            var newDigit = (digit + nextDigit) / 2

                            horizontalListInterpolated.push(newDigit)
                        }
                    })

                    arrayToReturn.push(horizontalListInterpolated)

                })
                return arrayToReturn;
            }



            function interpolateVertically(arrayToInterpolate){

                var returnArray = []

                arrayToInterpolate.forEach( function(horizontalList1,index, vertList){

                    returnArray.push(horizontalList1)

                    var horizontalList2

                    if(index == vertList.length-1){
                        horizontalList2 = vertList[0]
                    } else {
                        horizontalList2 = vertList[index+1]
                    }

                    var horizontalListMiddle = []

                    console.log("horizontal lists");
                    console.log(horizontalList1);
                    console.log(horizontalList2);

                    for (var i = 0; i < horizontalList1.length; i++) {

                        var digit1 = horizontalList1[i];
                        var digit2 = horizontalList2[i];

                        horizontalListMiddle.push((digit1+digit2)/2)

                    };

                    returnArray.push(horizontalListMiddle)
                })
                return returnArray
            }
            var returnData = dataToInterpolate

            var i = 0;



            while (i < howManyTimes) {
                returnData = interpolateHorizontally(returnData)
                returnData = interpolateVertically(returnData)
                i++;
            }

            return returnData
        }




        //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
        //
        //          DRAWING PART
        //
        //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


        function drawGraphic()
        {



            var transformElectricityData = transformData(listElectricity[dayIndex])
            var transformColdWaterData = transformData(listColdWater[dayIndex])
            var transformWarmWaterData = transformData(listWarmWater[dayIndex])

            var interpolatedElectricityData = interpolateData(transformElectricityData, 4)
            var interpolatedColdWaterData = interpolateData(transformColdWaterData, 4)
            var interpolatedWarmWaterData = interpolateData(transformWarmWaterData, 4)

            var svgContainer = d3.select(".col-md-12")
                            .append("svg")
                            .attr("width", 1000)
                            .attr("height", 800)


            var pathsContainer = svgContainer.append("g")


            var colorScale1 = d3.scale.linear()
                                                    .domain([0, 1, 4, 9])
                                                    .range(["#dbdada","#fff800", "#c3ff00", "#70b70f"]);


            var colorScale2 = d3.scale.linear()
                                                    .domain([0, 1, 4, 9])
                                                    .range(["#e5e2e2","#90b2fb", "#0355e1", "#103585"]);

            var colorScale3 = d3.scale.linear()
                                                    .domain([0, 1, 4, 9])
                                                    .range(["#eeeeee","#ff9a00", "#fb0101", "#a5150d"]);

            drawDataset(interpolatedElectricityData, 50, 70, pathsContainer,colorScale1)
            drawDataset(interpolatedColdWaterData, 120, 70, pathsContainer,colorScale2)
            drawDataset(interpolatedWarmWaterData, 190, 70, pathsContainer,colorScale3)


            //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
            //
            //          VIEW TRANSFORMATION PART
            //
            //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

            pathsContainer.attr("transform", "translate("+
                                                    svgContainer.attr("width")/2
                                                            +","+
                                                    svgContainer.attr("height")/2
                                                            +")")



            document.getElementById('rendering').style.display = 'none';
            var svg = document.body.querySelector('svg');
            svg.onclick = function() {


                dayIndex++;
                dayIndex %= 7;

                var oldSvg = document.body.querySelector('svg');
                if (oldSvg)
                {
                    oldSvg.parentNode.removeChild(oldSvg);
                }
                document.getElementById('rendering').style.display = 'block';

                setTimeout(drawGraphic, 2000);
            }

        }







        function drawDataset(data,radiusStart,totalSize,container,colorScale){

            data.forEach(function(d,y,yArr) {

                d.forEach(function(digit,x,xArr) {

                    /*svgContainer.append("rect")
                            .attr("x", 22*j)
                            .attr("y", 22*i)
                            .attr("width",20)
                            .attr("height", 20)*/

                        var radiusSizeSegment = totalSize/xArr.length

                        var radiusStep = radiusSizeSegment

                        var angleStep = 2*Math.PI/yArr.length
                        var angleSize = angleStep


                        var arc = d3.svg.arc()
                                .innerRadius(radiusStart          + x*radiusStep)
                                .outerRadius(radiusStart+radiusSizeSegment  + x*radiusStep)
                                .startAngle(y*angleStep)
                                .endAngle(angleSize + y*angleStep)


                        var color


                        color = colorScale(digit)




                        container.append("path")
                            .attr("d", arc)
                            .style("fill",color)
                            .style("stroke",color)
                            .style("stroke-width",3)

                })

            })
        }




        drawGraphic()



        </script>

        </div></div></div>

        <a class="btn" href="Explanations.html">Learn more about this visualization</a>
                </div>
      </body>
</html>



<!--
Terminal code
n144-p156:KTH Vera$ cd ~/Documents/KTH/Information\ Visualization/Assignment\ 2/Project/
n144-p156:Project Vera$ python -m SimpleHTTPServer 8888 & -->